@using LudereAI.Shared.Enums
@model AccountViewModel
@{
    ViewData["Title"] = "Account Management";
}

<header class="site-header">
    <div class="hero-section text-center text-white" data-aos="zoom-in">
        <div class="overlay"></div>
        <div class="container d-flex flex-column justify-content-center align-items-center content"
             style="height: 100%;">
            <h1 class="display-1 fw-bold"><i class="fas fa-user-cog"></i> Account Management</h1>
            <p class="lead">Manage your profile, security settings, and subscription</p>
        </div>
    </div>
</header>

<div class="container py-5">
    <div class="row">
        <div class="col-md-3 mb-4">
            <div class="pricing-card p-0" data-aos="fade-up">
                <div class="list-group list-group-flush">
                    <a href="#profile" class="list-group-item list-group-item-action active" data-bs-toggle="list"
                       aos="flip-left" data-aos-delay="100">
                        <i class="fas fa-user-circle me-2"></i>Profile
                    </a>
                    <a href="#security" class="list-group-item list-group-item-action" data-bs-toggle="list"
                       data-aos="flip-left" data-aos-delay="200">
                        <i class="fas fa-shield-alt me-2"></i>Security
                    </a>
                    <a href="#subscription" class="list-group-item list-group-item-action" data-bs-toggle="list"
                       data-aos="flip-left" data-aos-delay="300">
                        <i class="fas fa-crown me-2"></i>Subscription
                    </a>
                    <a href="#notifications" class="list-group-item list-group-item-action" data-bs-toggle="list"
                       data-aos="flip-left" data-aos-delay="400">
                        <i class="fas fa-bell me-2"></i>Notifications
                    </a>
                </div>
            </div>
        </div>

        <div class="col-md-9">
            <div class="tab-content">
                <div class="tab-pane fade show active" id="profile">
                    <div class="pricing-card p-4">
                        <h2 class="mb-4"><i class="fas fa-user-circle me-2"></i>Profile Information</h2>
                        <form method="post" action="/Account/UpdateProfile">
                            <div class="row mb-4">
                                <div class="col-md-6">
                                    <label for="firstName" class="form-label">First Name</label>
                                    <input type="text" id="firstName" name="firstName" class="form-control"
                                           value="@Model.Account.FirstName"/>
                                </div>
                                <div class="col-md-6">
                                    <label for="lastName" class="form-label">Last Name</label>
                                    <input type="text" id="lastName" name="lastName" class="form-control"
                                           value="@Model.Account.LastName"/>
                                </div>
                            </div>

                            <div class="mb-4">
                                <label for="username" class="form-label">Username</label>
                                <input type="text" id="username" name="username" class="form-control"
                                       value="@Model.Account.Username"/>
                            </div>

                            <div class="mb-4">
                                <label for="email" class="form-label">Email Address</label>
                                <input type="email" id="email" name="email" class="form-control"
                                       value="@Model.Account.Email"/>
                            </div>

                            <button type="submit" class="btn btn-primary">Save Changes</button>
                        </form>
                    </div>
                </div>

                <div class="tab-pane fade" id="security">
                    <div class="pricing-card p-4">
                        <h2 class="mb-4"><i class="fas fa-shield-alt me-2"></i>Security Settings</h2>

                        <div class="mb-4">
                            <h4>Change Password</h4>
                            <form method="post" action="/Account/ChangePassword">
                                <div class="mb-3">
                                    <label for="currentPassword" class="form-label">Current Password</label>
                                    <input type="password" id="currentPassword" name="currentPassword"
                                           class="form-control" required/>
                                </div>
                                <div class="mb-3">
                                    <label for="newPassword" class="form-label">New Password</label>
                                    <input type="password" id="newPassword" name="newPassword" class="form-control"
                                           required/>
                                </div>
                                <div class="mb-3">
                                    <label for="confirmNewPassword" class="form-label">Confirm New Password</label>
                                    <input type="password" id="confirmNewPassword" name="confirmNewPassword"
                                           class="form-control" required/>
                                </div>
                                <button type="submit" class="btn btn-primary">Update Password</button>
                            </form>
                        </div>

                        <hr class="my-4">

                        <div class="mb-4">
                            <h4>Two-Factor Authentication</h4>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="twoFactorEnabled">
                                <label class="form-check-label" for="twoFactorEnabled">Enable Two-Factor
                                    Authentication</label>
                            </div>
                            <small class="text-muted">Enhance your account security by enabling two-factor
                                authentication.</small>
                        </div>

                        <hr class="my-4">

                        <div class="mb-4">
                            <h4>Login History</h4>
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Location</th>
                                        <th>Device</th>
                                        <th>Status</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td>2024-02-09 10:30 AM</td>
                                        <td>New York, USA</td>
                                        <td>Windows PC</td>
                                        <td><span class="badge bg-success">Success</span></td>
                                    </tr>
                                    <tr>
                                        <td>2024-02-08 03:15 PM</td>
                                        <td>New York, USA</td>
                                        <td>iPhone</td>
                                        <td><span class="badge bg-success">Success</span></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="subscription">
                    <div class="pricing-card p-4">
                        <h2 class="mb-4"><i class="fas fa-crown me-2"></i>Subscription Management</h2>

                        @if (!Model.Account.IsSubscribed)
                        {
                            <div class="alert alert-danger bg-danger text-white border-0 mb-4">
                                <div class="d-flex align-items-center">
                                    <div>
                                        <h4 class="mb-2">No Active Subscription</h4>
                                        <p class="mb-0">Subscribe to a plan to unlock premium features</p>
                                    </div>
                                </div>
                            </div>

                            <div class="container">
                                <div class="mb-4">
                                    <h4>Available Plans</h4>

                                    <div class="pricing-toggle mb-4">
                                        <ul class="nav nav-pills justify-content-center" id="pricingTab" role="tablist">
                                            <li class="nav-item" role="presentation">
                                                <button class="nav-link active" id="monthly-tab" data-bs-toggle="pill"
                                                        data-bs-target="#monthly" type="button" role="tab"
                                                        aria-controls="monthly" aria-selected="true">
                                                    Monthly
                                                </button>
                                            </li>
                                            <li class="nav-item" role="presentation">
                                                <button class="nav-link" id="yearly-tab" data-bs-toggle="pill"
                                                        data-bs-target="#yearly" type="button" role="tab"
                                                        aria-controls="yearly" aria-selected="false">
                                                    Yearly
                                                </button>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="tab-content" id="pricingTabContent">
                                        <div class="tab-pane fade show active" id="monthly" role="tabpanel"
                                             aria-labelledby="monthly-tab">
                                            <div class="row g-2 justify-content-center">
                                                @await Html.PartialAsync("_PricingPlan", new PricingPlanViewModel
                                                {
                                                    Title = "Pro",
                                                    Description = "For competitive players chasing leaderboards",
                                                    Price = "$12.99",
                                                    PriceInterval = "month",
                                                    Features =
                                                    [
                                                        "Unlimited Messages",
                                                        "Unlimited Screenshots",
                                                        "Auto-Screenshot Analysis",
                                                        "AI Voice Responses (Basic TTS)",
                                                        "7 Sessions History",
                                                        //"1 Custom AI Persona",
                                                        "Priority Response Speed"
                                                    ],
                                                    ShowCTAButton = true,
                                                    CtaText = "Start Trial",
                                                    AnimationDelay = 200,
                                                    Badge = "Recommended",
                                                    BadgeClass = "bg-warning text-dark",
                                                    IsShine = true,
                                                    IsPulse = true,
                                                    IsFormSubmit = true,
                                                    FormController = "Subscription",
                                                    FormAction = "Subscribe",
                                                    FormMethod = "post",
                                                    FormParameters = new Dictionary<string, object>
                                                    {
                                                        ["plan"] = SubscriptionPlan.Pro,
                                                    },
                                                    ColumnWidth = 6
                                                })

                                                @await Html.PartialAsync("_PricingPlan", new PricingPlanViewModel
                                                {
                                                    Title = "Ultimate",
                                                    Description = "For streamers, pros, and hardcore tacticians",
                                                    Price = "$19.99",
                                                    PriceInterval = "month",
                                                    Features =
                                                    [
                                                        "All Pro Tier Features",
                                                        "Real-Time Analysis",
                                                        "Two-Way Voice Chat (Premium TTS)",
                                                        //"5 Custom AI Personas + Shared Personas",
                                                        "Unlimited Session Archive + Search",
                                                        "Hardware Optimization Tips",
                                                        "Priority 24/7 Support",
                                                        "Early Access to New Features"
                                                    ],
                                                    ShowCTAButton = true,
                                                    CtaText = "Subscribe",
                                                    AnimationDelay = 300,
                                                    Badge = "Most Popular",
                                                    BadgeClass = "bg-danger",
                                                    IsShine = true,
                                                    IsFormSubmit = true,
                                                    FormController = "Subscription",
                                                    FormAction = "Subscribe",
                                                    FormMethod = "post",
                                                    FormParameters = new Dictionary<string, object>
                                                    {
                                                        ["plan"] = SubscriptionPlan.Ultimate,
                                                    },
                                                    ColumnWidth = 6
                                                })
                                            </div>
                                        </div>

                                        <div class="tab-pane fade" id="yearly" role="tabpanel"
                                             aria-labelledby="yearly-tab">
                                            <div class="row g-4 justify-content-center">
                                                @await Html.PartialAsync("_PricingPlan", new PricingPlanViewModel
                                                {
                                                    Title = "Pro",
                                                    Description = "For competitive players chasing leaderboards",
                                                    Price = "$129.99",
                                                    PriceInterval = "year",
                                                    Features =
                                                    [
                                                        "Unlimited Messages",
                                                        "Unlimited Screenshots",
                                                        "Auto-Screenshot Analysis",
                                                        "AI Voice Responses (Basic TTS)",
                                                        "7 Sessions History",
                                                        //"1 Custom AI Persona",
                                                        "Priority Response Speed"
                                                    ],
                                                    ShowCTAButton = true,
                                                    CtaText = "Start Trial",
                                                    AnimationDelay = 200,
                                                    Badge = "Recommended",
                                                    BadgeClass = "bg-warning text-dark",
                                                    IsShine = true,
                                                    IsPulse = true,
                                                    IsFormSubmit = true,
                                                    FormController = "Subscription",
                                                    FormAction = "Subscribe",
                                                    FormMethod = "post",
                                                    FormParameters = new Dictionary<string, object>
                                                    {
                                                        ["plan"] = SubscriptionPlan.ProYearly,
                                                    },
                                                    ColumnWidth = 6
                                                })

                                                @await Html.PartialAsync("_PricingPlan", new PricingPlanViewModel
                                                {
                                                    Title = "Ultimate",
                                                    Description = "For streamers, pros, and hardcore tacticians",
                                                    Price = "$199.99",
                                                    PriceInterval = "year",
                                                    Features =
                                                    [
                                                        "All Pro Tier Features",
                                                        "Real-Time Analysis",
                                                        "Two-Way Voice Chat (Premium TTS)",
                                                        //"5 Custom AI Personas + Shared Personas",
                                                        "Unlimited Session Archive + Search",
                                                        "Hardware Optimization Tips",
                                                        "Priority 24/7 Support",
                                                        "Early Access to New Features"
                                                    ],
                                                    ShowCTAButton = true,
                                                    CtaText = "Subscribe",
                                                    AnimationDelay = 300,
                                                    Badge = "Most Popular",
                                                    BadgeClass = "bg-danger",
                                                    IsShine = true,
                                                    IsPulse = true,
                                                    IsFormSubmit = true,
                                                    FormController = "Subscription",
                                                    FormAction = "Subscribe",
                                                    FormMethod = "post",
                                                    FormParameters = new Dictionary<string, object>
                                                    {
                                                        ["plan"] = SubscriptionPlan.UltimateYearly,
                                                    },
                                                    ColumnWidth = 6
                                                })
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        }
                        else
                        {
                            <div class="card bg-primary text-white p-4 mb-4">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h4 class="mb-2">Current Plan: @Model.Account.Subscription?.PlanFriendlyName</h4>
                                        <p class="mb-0">@Model.Account.Subscription?.FriendlyEndDate()</p>
                                    </div>
                                    <span
                                        class="badge bg-warning text-dark">@Model.Account.Subscription?.StatusFriendlyName</span>
                                </div>
                            </div>

                            <div class="mb-4">
                                <h4>Your Plan Features</h4>
                                <ul class="list-unstyled">

                                </ul>
                            </div>


                            <hr class="my-4">

                            <div class="d-flex justify-content-between align-items-center">
                                <form method="post" asp-controller="Subscription" asp-action="CustomerPortal" class="d-inline">
                                    <button type="submit" class="btn btn-primary">
                                        <i class="fas fa-external-link-alt me-2"></i>Manage Subscription
                                    </button>
                                </form>
                            </div>
                        }
                    </div>
                </div>

                <div class="tab-pane fade" id="notifications">
                    <div class="pricing-card p-4">
                        <h2 class="mb-4"><i class="fas fa-bell me-2"></i>Notification Settings</h2>

                        <div class="mb-4">
                            <h4>Email Notifications</h4>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="emailUpdates" checked>
                                <label class="form-check-label" for="emailUpdates">
                                    Product Updates and News
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="emailBilling" checked>
                                <label class="form-check-label" for="emailBilling">
                                    Billing and Subscription
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="emailSecurity">
                                <label class="form-check-label" for="emailSecurity">
                                    Security Alerts
                                </label>
                            </div>
                        </div>

                        <hr class="my-4">

                        <div class="mb-4">
                            <h4>Desktop Notifications</h4>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="desktopAlerts" checked>
                                <label class="form-check-label" for="desktopAlerts">
                                    Enable Desktop Alerts
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="gameAlerts" checked>
                                <label class="form-check-label" for="gameAlerts">
                                    Game-specific Alerts
                                </label>
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary">Save Preferences</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>